---
layout: post
title: "[GAN] What Is a Generative Adversarial Network?"
date: 2022-03-13 08:44:38 -0400
category: deep-learning
author: eun
short-description: 생성적 적대 신경망이란?
toc: true
---

#### intro
---
생성적 적대(Generative Adversarial Network, GAN)은 오늘날 딥러닝 분야에서 중요한 연구 주제이다. 이 아키텍처를 사용하면 일반적인 방식으로는 학습하게 하기 힘든 생성 모델까지 제작해 낼 수 있기 때문이다. 이 아키텍처를 사용하면 얻게 되는 이점은 여러가지이다.
- 데이터가 한정된 상황에서 **일반화**`Generalization` 가능
- 작은 데이터셋을 가지고 새로운 장면을 만들 수 있음
- **모조 데이터**`simulated data`를 더욱 진짜처럼 보이게 할 수 있음
- 작은 데이터만 가지고 다양한 일을 할 수 있다는 장점이 있다. 
    + 오늘날에 사용되는 다양한 기수을 구현하려면 상당히 많은 데이터가 필요하다.
    + 여러 가지 과업들을 완성하는 데 필요한 데이터 분량을 축소할 수 있음
    + 다른 아키텍처을 사용해 딥러닝 문제를 풀 떄에 비해 10%의 데이터만 있어도 문제를 풀 수 있음

<br>

#### generative modeling & discriminative modeling
---

- **GAN: 적대적 생성모델**
- **두 개 이상의 신경망이 서로를 향하게 하고, 서로 대항하듯이 훈련하게 함으로써, 결과적으로 생성 모델을 산출해낸다.**

머신러닝과 딥러닝은 **생성 모델링(`generative modeling`)** 및 **판별 모델링(`discriminative modeling`)**이라는 두 가지 용어로 설명할 수 있다. 머신러닝의 **분류(`classifaction`)** 기법은 전형적인 판별 모델링 기술에 해당한다.

<p align="center"><img src="/assets/images/gan3.png" width="70%" height="70%"></p>

<p style="font-size: 1.12em">📌 판별 모델링</p>
- **판별 모델**: 실제 데이터와 생성 모델이 생성한 가짜 데이터를 구별하도록 학습
- 예) 그림을 살펴본 다음 해당 그림의 화풍`style`을 정하는 일은 무엇인가 판단하는 일
- 판별 모델링 수행 방식
1. 데이터 내의 각 부분을 이해하기 위해 합성곱 계층을 만들거나, 기타 학습된 특징들을 사용하는 머신러닝 모델을 만든다.
2. 훈련 집합(전체 데이터 중 60~90%)과 검증 집합(전체 데이터 중 10~40%)이 모두 포함된 데이터셋을 수집한다
3. 전체 데이터를 사용해 머신러닝 모델을 훈련한다
4. 머신러닝 모델을 사용해 **데이터가 어떤 특정 계급`(classes`)에 속하는지** 예측한다. 
- 판별 모델의 작동 방식
    + **분포(`distributions`)**에 대한 계급 간의 **경계 조건(`boundary conditions`)**을 학습
    + 데이터가 많을 수록 판별 모델의 성능이 좋아진다
    + 비지도 방식 X: 레이블`label`이 지정되지 않은 데이터 사용 가능 X
    + 결정 경계만 학습하면 된다
<p align="center"><img src="/assets/images/gan13.png" width="30%" height="30%"></p>


<p style="font-size: 1.12em">📌 생성 모델링</p>
- **생성 모델**: 생성된 데이터를 받아, 실제 데이터와 비슷한 가짜 데이터를 만들어내도록 학습
- 예) 화풍에 대한 지식을 쌓고, 다양한 화가의 화풍에 따라 그림을 재현하는 것
- 생성 모델링 수행 방식
1. 다양한 그림의 화풍을 **복제(`reproduce`)**하는 방법을 학습하는 머신러닝 모델 작성한다.
2. 훈련 데이터셋과 검증 데이터셋 수집한다.
3. 수집한 데이터를 사용해 머신러닝 모델을 훈련한다.
4. 머신러닝 모델을 사용해 그림 작가가 그린**사례(`examples`)**를 바탕으로 예측한다.  즉, **유사도(`similarity`)**라고 하는 **계랑기준(`metrics`)**을 사용해 모델에서 화풍을 재현하는 기능을 확인한다.
- 생성 모델의 작동 방식
    + 주어진 입력의 분포에 대한 계급들의 분포를 모델링한다
    + 분포를 추정하기 위해 각 계급에 대한 확률 모델을 만든다
    + 레이블 없는 데이터 사용 가능: 훈련을 하는 중 알아서 레이블 학습
    + 입력 분포를 정확하게 모델링하고 복제해야 하므로, 힌계 이상의 무언가를 새로 산출해 내기가 어렵다.
<p align="center"><img src="/assets/images/gan14.png" width="30%" height="30%"></p>

<br>

#### GAN의 구조 
---
GAN이라는 신경망 아키텍처를 구성하려면 몇 가지 주요 구성 요소가 필요하다.
1. 케라스(Keras)나 파이토치(PyTorch)
    - 텐서플로우를 백엔드로 사용하는 프런트엔드 프레임워크
    - 신경망을 쉽게 생성할 수 있게해주는 메서드를 모아 놓은 것
2. 생성기와 판별기: 두 가지 신경망 기반 구성 요소 

<p style="font-size: 1.12em">📌 GAN의 수행 방법</p>
- 생성기: 화폐 위조범 
- 판별기: FBI 요원

위조범은 FBI 요원의 검사를 통과할 수 있는 위조 지폐를 만드는 새로운 방법을 끊임없이 모색한다. 
이 두 구성요소의 목표를 세분화하면 다음과 같다.
- **위조범에 해당하는 생성기의 목표**: 경찰이 진짜 화폐와 가짜 화폐를 구별하지 못하도록 화폐 생성
- **경찰에 해당하는 판별기의 목표**: 진짜 화폐와 가짜 화폐을 분류해 나는 사전 경험을 바탕으로 예외적인 제품을 탐지

<p style="font-size: 1.12em">📌 GAN의 작동 방법</p>
첫번째 GAN의 구현의 최소최대 문제(가장 큰 손실에서 함수를 최대화하는 데 중점을 둔 이론)이다. 이 단계들은 이러한 유형의 문제를 만들어낸다.
- **생성기의 목표**: 진짜 같은 가짜 출력을 생성해 내어 판별기가 실수로 진짜와 가짜를 잘못 분류하게 되는 가능성을 극대화
- **판별기의 목표**: 판별기가 진짜 이미지와 생성된 이미지를 구별하지 못할 확률 목표인 0.5를 달성하게 되기 전까지 최적화
- 최소최대 문제
    + GAN의 경우, 훈련하는 두 모델로 표현 가능
    + 훈련 단계에서 생성기에 대한 훈련 손실 오차를 최소화하는데 중점
    + 그 과정에서 판별기의 판별 확률은 가능한 0.5에 근접해져야한다.(판별기가 진짜인지 가짜인지 구분하기 힘들게)

GAN 프레임워크에서 생성기는 판별기와 동시에 훈련을 시작해야하지만, 실제로는 판별기가 이미지를 분류할 수 있어야하므로, 대체로 훈련을 시작하기 전에 판별기부터 훈련해야한다. 손실 함수(`loss funciont`)을 기준으로 삼아 생성기와 판별기를 훈련하는도중일지라도 훈련을 중단할 수 있다. 
<p align="center"><img src="/assets/images/gan15.png" width="60%" height="60%"></p>

위 그림은 생성적 적대 신경망의 흐름을 추상적으로 형태로 나타낸 그림으로, 각 사각형이 각 기본 함수를 의미한다. 생성기는 오차가 최대화 되도록, 판별기는 오차가 최소화 되도록 훈련한다. 


<br>


<!-- ![Image Alt 텍스트](https://post-phinf.pstatic.net/MjAxODA4MDJfMTU5/MDAxNTMzMTg1NjIyODk0.PQRCts3UHTjC2Y3YZInqHaSVYKNzKyASqLaSqo2j3BEg.a4qXJ8U7i-7wNec_irjGVlY9cuZSb2S68Dif80JVykAg.PNG/4GAN%ED%95%99%EC%8A%B5%EA%B3%BC%EC%A0%95_%EC%88%98%EC%A0%952.PNG?type=w1200){: width="70%" height="70%"} 

---

<p style="font-size: 1.0em">References</p>
<a href = "https://post.naver.com/viewer/postView.nhn?volumeNo=16425037&memberNo=36733075&vType=VERTICAL" style="font-size: 0.8em"> [새로운 인공지능 기술 GAN] ① 스스로 학습하는 인공지능 </a>      
<a href = "https://m.post.naver.com/viewer/postView.nhn?volumeNo=16566740&memberNo=36733075" style="font-size: 0.8em"> [새로운 인공지능 기술 GAN] ② GAN의 개념과 이해</a>       
<a href = "https://post.naver.com/viewer/postView.nhn?volumeNo=16706734&memberNo=36733075" style="font-size: 0.8em"> [새로운 인공지능 기술 GAN] ③ GAN의 활용 사례와 발전방향</a> -->