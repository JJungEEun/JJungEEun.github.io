---
layout: post
title: "[머신러닝] 교통사고 건수 예측모델"
date: 2021-01-21 08:44:38 -0400
category: project
subcategory: 
author: eun
short-description: 교통사고 발생에 관여하는 주요 변수를 파악해 교통사고 건수를 예측하는 머신러닝 모델
---

-----

#### 프로젝트 주제 및 목적
![Image Alt 텍스트](/assets/images/project01_01.png){: width="60%" height="60%"}    
교통사고 발생 예방을 위한 제도적, 교육적 장치가 다수 존재하며 교통사고 잠재 변인 파악을 위한 빅데이터 분석 관련 선행 연구도 수차례 진행되었다.
그러나 근시일의 교통사고 발생을 예측하고 실질적으로 예방하기 위한 노력은 부족한 실정이다.   

따라서, **교통사고 발생에 관여하는 주요 변수를 파악해 교통사고 건수를 예측하는 머신러닝 모델**을 만들고자 했다. 이를 위해 메인 모델을 서울시 데이터로 훈련시킨 후 지역별 데이터로 일반화 가능성을 검증했다.

#### 데이터 시각화
- 시간대별 교통사고 건수 시각화     
![Image Alt 텍스트](/assets/images/pro01_02.png){: width="60%" height="60%"}    
순서대로 월별, 요일별, 시간대별 교통사고 건수를 시각화한 것이다. 
    + 월별 교통사고 건수: 각 년도의 월별 교통사고 건수를 시각화한 결과 <u>월</u>과 교통사고 사이의 연관성이 존재함을 확인할 수 있었다.
    + 요일별 교통사고 건수: 각 년도의 요일별 교통사고 건수를 시각화한 결과 <u>요일</u>과 교통사고 사이의 연관성이 존재함을 확인할 수 있었다. 상대적으로 일요일에 가장 적게, 금요일 교통사고가 자주 일어나고 있었다.
    + 발생시간별 교통사고 건수 시각화: 각 년도의 발생시간별 교통사고 건수를 시각화한 결과 <u>발생시간</u>과 교통사고 사이에 연관성을 존재함을 확인할 수 있었다. 출퇴근 시간인 오전 8시와 오후 6시에 교통사고가 급격히 증가하고 있었다.
- 지역별 교통사고 건수 시각화       
![Image Alt 텍스트](/assets/images/pro01_03.png){: width="50%" height="50%"}  
    순서대로 지역구별, 시간대별 교통사고 건수를 시각화한 것이다.
    + 지역구별 교통사고 건수: 지역별 교통사고 건수를 시각화한 결과,강남구의 사고건수가 압도적으로 많았고, 사고건수와 경상자수가 유사했다. 사고로 인한 부상자는 대부분 경상자인 것 을 알 수 있었다
    + 지역구의 시간대별 교통사고 건수: 시간대와 지역별 교통사고 건수를 시각화한 결과, 위에서 본 전체 발생시간별 교통사고 건수와 shape이 유사했고 역시나 출퇴근 시간에 교통사고 건수가 증가하고 있었다.

![Image Alt 텍스트](/assets/images/pro01_04.png){: width="70%" height="70%"}    
    지역별 사고건수를 지도에 시각화한 결과, 강남구, 송파구, 영등포구, 서초구가 많은 비율을 차지하고 있었다.

#### 데이터 전처리

#### 모델링
##### 시간대/지역별 교통사고 건수 예측 초기 모델
교통사고 발생건수 예측 모델로 랜덤 포레스트 / 선형 회귀 / 선형 로그 회귀 모델로 선정하고 편의를 위해 모델 생성 함수를 따로 정의했다. 
- 모델 성능 평가 지표: MSE, R^2, K-Fold 후의 CV정확도 사용
- 첫 300개 샘플에 대해 실제 데이터와 예측 데이터 분포의 상이함을 시각화

타깃 변수와의 연관성이 높은 발생월과 부상자수로 모델을 학습시킨 결과, 사고건수의 경우 이분산성이 크지 않아 로그 변환 시 모델의 성능이 급격히 감소했으며 랜덤 포레스트
모델의 성능이 가장 우수함을 확인했다. 이는 교통 사고 건수에 영향을 미치는 요인에는 연속형 변수보다는 범주형 변수가 많으며, 선형적 관계보다는 비선형적 관계를 지니는 변수가 많았기 때문으로 추측된다.
따라서 이후 단계부터는 랜덤 포레스트 모델을 중점적으로 훈련시키기로 결론지었다.

직관적으로 중요하다고 보여지는 특성들부터 차례로 예측 모델에 추가하면서 모델 성능의 변화 과정을 추적했다.
너무 많은 특성 변수를 채택할 경우의 과대적합을 우려했으나, 실제로 학습을 진행한 결과 모든 특성을 추가하였을 때 모델 성능이 가장
뛰어났다. 또한, 원 핫 인코딩 과정을 생략했음에도 0.946이라는 상당히 높은 평균 CV 점수를 얻을 수 있었다.
그러나 <u>가해자 차량, 연령 등 교통 사고 사후적 요인이 특성에 포함되어 있어, 이를 제거하고도 높은 성능을 유지시킬 방법에 대한 추가 논의가 필요</u>하다. 
##### 랜덤 포레스트 조합 함수를 이용한 변수 선택
##### 서울시 교통사고 건수 최종 모델
##### 예측 모델 적용(다른 지역)

#### sum 모델과 mean 모델 성능 비교

#### 추후 교통 사고 건수 예측 모델
##### 기상상태 예측 시도
##### 일자별 교통사고 건수 예측 모델 추가 구현

#### 최종 결과
#### 의의와 한계



